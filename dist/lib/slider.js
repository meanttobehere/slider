!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("slider",[],e):"object"==typeof exports?exports.slider=e():t.slider=e()}(self,(function(){return(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);const e=function(){function t(t,e,i){var s=this;this.handleObjectMouseMove=function(t){var e=s.calcPositionInPercent(t.clientX-s.offsetX,t.clientY-s.offsetY);s.observer.move(e,s.isSecond)},this.handleObjectMouseUp=function(){$(document).off("mousemove",s.handleObjectMouseMove),s.observer.endMove(s.isSecond)},this.handleObjectMouseDown=function(t){$(document).on("mousemove",s.handleObjectMouseMove),$(document).one("mouseup",s.handleObjectMouseUp),s.offsetX=t.offsetX-s.$object[0].clientWidth/2,s.offsetY=t.offsetY-s.$object[0].clientHeight/2,s.observer.startMove(s.isSecond)},this.handleObjectTouchMove=function(t){var e=s.calcPositionInPercent(t.touches[0].clientX,t.touches[0].clientY);s.observer.move(e,s.isSecond),t.preventDefault(),t.stopPropagation()},this.handleObjectTouchEnd=function(){document.removeEventListener("touchmove",s.handleObjectTouchMove),s.observer.endMove(s.isSecond)},this.handleObjectTouchStart=function(t){document.addEventListener("touchmove",s.handleObjectTouchMove,{passive:!1}),document.addEventListener("touchend",s.handleObjectTouchEnd,{once:!0}),t.preventDefault(),t.stopPropagation(),s.observer.startMove(s.isSecond)},this.$object=t,this.observer=e,this.isSecond=Boolean(i),this.initMouseEvents(),this.initTouchEvents()}return t.prototype.update=function(t){this.isVertical=t.isVertical},t.prototype.initMouseEvents=function(){this.$object.on("mousedown",this.handleObjectMouseDown)},t.prototype.initTouchEvents=function(){this.$object[0].addEventListener("touchstart",this.handleObjectTouchStart,{passive:!1})},t.prototype.calcPositionInPercent=function(t,e){var i=this.$object.parent()[0];return this.isVertical?(e-i.getBoundingClientRect().top)/i.offsetHeight*100:(t-i.getBoundingClientRect().left)/i.offsetWidth*100},t}(),i=function(){function t(t,i,s){this.isSecond=Boolean(s),this.createDomElements(t),this.moveableObject=new e(this.$pointer,i,s)}return t.prototype.render=function(t){if(this.shouldBeDisplayed(t)){this.$pointer.show();var e=this.isSecond?t.secondPointerPosPercentage:t.pointerPosPercentage;t.isVertical?this.$pointer.css({top:e+"%",left:""}):this.$pointer.css({left:e+"%",top:""}),this.moveableObject.update(t)}else this.$pointer.hide()},t.prototype.setLayerLevel=function(t){this.$pointer.css("zIndex",t)},t.prototype.createDomElements=function(t){this.$pointer=$("<div>",{class:"slider__pointer"}),t.append(this.$pointer)},t.prototype.shouldBeDisplayed=function(t){return!this.isSecond||t.isRange},t}(),s=function(){function t(t,e){this.observer=e,this.createDomElements(t),this.attachEvents()}return t.prototype.render=function(t){if(this.isVertical=t.isVertical,t.shouldDisplayProgressBar){this.$progressBar.show();var e=t.pointerPosPercentage,i=t.secondPointerPosPercentage,s=t.isRange?[Math.min(e,i),Math.abs(e-i)]:[0,e],n=s[0],o=s[1];t.isVertical?(this.$progressBar.css({height:o+"%",width:""}),this.$progressBar.css({top:n+"%",left:""})):(this.$progressBar.css({width:o+"%",height:""}),this.$progressBar.css({left:n+"%",top:""}))}else this.$progressBar.hide()},t.prototype.createDomElements=function(t){this.$bar=$("<div>",{class:"slider__bar"}),this.$progressBar=$("<div>",{class:"slider__progress-bar"}),t.append(this.$bar),this.$bar.append(this.$progressBar)},t.prototype.attachEvents=function(){this.$bar.on("click",this.handleBarClick.bind(this))},t.prototype.handleBarClick=function(t){var e=this.$bar[0],i=this.isVertical?(t.clientY-e.getBoundingClientRect().top)/e.offsetHeight*100:(t.clientX-e.getBoundingClientRect().left)/e.offsetWidth*100;this.observer.click(i)},t}(),n=function(){function t(t,e){this.observer=e,this.createDomElements(t)}return t.prototype.render=function(t){if(t.shouldDisplayScale){this.$scale.show();var e=this.getLabelsData(t);this.updateNumOfLabels(e.length),this.$labels.each((function(i){var s=$(this),n=e[i];s.data("pos",n.posPercentage),s.text(n.val),t.isVertical?s.css({top:n.scalePos+"%",left:""}):s.css({left:n.scalePos+"%",top:""})}))}else this.$scale.hide()},t.prototype.createDomElements=function(t){this.$scale=$("<div>",{class:"slider__scale"}),t.append(this.$scale)},t.prototype.handleLabelClick=function(t){var e=$(t.currentTarget).data("pos");this.observer.click(e)},t.prototype.updateNumOfLabels=function(t){for(;this.$labels.length!==t;)this.$labels.length<t?this.$scale.append(this.createLabel()):this.$labels.last().remove()},t.prototype.createLabel=function(){var t=$("<div>",{class:"slider__scale-label"});return t.on("click",this.handleLabelClick.bind(this)),t},Object.defineProperty(t.prototype,"$labels",{get:function(){return this.$scale.children()},enumerable:!1,configurable:!0}),t.prototype.getLabelsData=function(t){for(var e=1,i=0,s=[];i<t.scaleLabels.length;){var n=this.getLabelData(t,i);this.isIntersection(s,n)?(s.length=0,i=0,e+=1):(s.push(n),i+=e)}return s},t.prototype.getLabelData=function(t,e){var i=t.scaleLabels[e],s=this.getLabelSizeInPercent(i.val,t),n=i.posPercentage-s/2,o=i.posPercentage+s/2,r={posPercentage:i.posPercentage,val:i.val,scalePos:i.posPercentage,start:n,end:o},a=[-1,101],c=a[0],h=a[1];return n<c?(r.start=c,r.end=c+s,r.scalePos=c+s/2):o>h&&(r.start=h-s,r.end=h,r.scalePos=h-s/2),r},t.prototype.isIntersection=function(t,e){return 0!==t.length&&t.some((function(t){return e.start<t.end+2.5}))},t.prototype.getLabelSizeInPercent=function(t,e){if(!this.context){var i=document.createElement("canvas").getContext("2d");i&&(i.font=this.getLabelFont(),this.context=i)}if(this.context){if(!e.isVertical){var s=this.$scale[0].clientWidth;return this.context.measureText(t).width/s*100}return 18/this.$scale[0].clientHeight*100}return 100},t.prototype.getLabelFont=function(){var t=this.createLabel();t.appendTo(this.$scale);var e=t.css("font-weight")||"normal",i=t.css("font-size")||"16px",s=t.css("font-family")||"Times New Roman";return t.remove(),e+" "+i+" "+s},t}(),o=function(){function t(t,i,s){this.isSecond=Boolean(s),this.createDomElements(t),this.moveableObject=new e(this.$tip,i,s)}return t.prototype.render=function(t){if(this.shouldBeDisplayed(t)){this.$tip.show();var e=this.getTipData(t);t.isVertical?this.$tip.css({top:e.pos+"%",left:""}):this.$tip.css({left:e.pos+"%",top:""}),this.$tip.text(e.val),this.moveableObject.update(t)}else this.$tip.hide()},t.prototype.setLayerLevel=function(t){this.$tip.css("zIndex",t)},t.prototype.createDomElements=function(t){this.$tip=$("<div>",{class:"slider__tip"}),t.append(this.$tip)},t.prototype.shouldBeDisplayed=function(t){return t.shouldDisplayTips&&(!this.isSecond||t.isRange)},t.prototype.getTipData=function(t){var e=this.isSecond?{pos:t.secondPointerPosPercentage,val:t.secondTipValue}:{pos:t.pointerPosPercentage,val:t.tipValue},i=this.getTipSizeInPercent(e.val,t),s=e.pos-i/2,n=e.pos+i/2,o=[-1,101],r=o[0],a=o[1];return s<r?e.pos=r+i/2:n>a&&(e.pos=a-i/2),e},t.prototype.getTipSizeInPercent=function(t,e){if(!this.context){var i=document.createElement("canvas").getContext("2d");i&&(i.font=this.getTipFont(),this.context=i)}if(this.context){if(!e.isVertical){var s=this.$tip.parent()[0].clientWidth;return this.context.measureText(t).width/s*100}return 18/this.$tip.parent()[0].clientHeight*100}return 100},t.prototype.getTipFont=function(){return(this.$tip.css("font-weight")||"normal")+" "+(this.$tip.css("font-size")||"16px")+" "+(this.$tip.css("font-family")||"Times New Roman")},t}();var r=function(){return r=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},r.apply(this,arguments)};const a=function(){function t(t,e){this.observer=e,this.createViewElements(t,this.makeObserverProxy()),this.attachEvents()}return t.prototype.render=function(t){this.props=r({},t),this.updateView()},t.prototype.updateView=function(){var t=this;this.props.isVertical?this.$container.addClass("slider__container_vertical"):this.$container.removeClass("slider__container_vertical"),[this.scale,this.bar,this.pointer,this.secondPointer,this.tip,this.secondTip].forEach((function(e){return e.render(t.props)}))},t.prototype.handleWindowResize=function(){this.updateView()},t.prototype.attachEvents=function(){window.addEventListener("resize",this.handleWindowResize.bind(this))},t.prototype.createViewElements=function(t,e){this.$container=$("<div>",{class:"slider__container"});var r=$("<div>",{class:"slider__scale-container"}),a=$("<div>",{class:"slider__bar-container"}),c=$("<div>",{class:"slider__tips-container"});this.$container.appendTo(t),this.$container.append(c).append(a).append(r),this.scale=new n(r,e),this.bar=new s(a,e),this.pointer=new i(a,e),this.secondPointer=new i(a,e,!0),this.tip=new o(c,e),this.secondTip=new o(c,e,!0)},t.prototype.makeObserverProxy=function(){var t=this;return r(r({},this.observer),{startMove:function(e){t.updateElementsLayerLevel(e),t.observer.startMove(e)}})},t.prototype.updateElementsLayerLevel=function(t){var e=t?[3,4]:[4,3],i=e[0],s=e[1];[this.tip,this.pointer].forEach((function(t){return t.setLayerLevel(i)})),[this.secondTip,this.secondPointer].forEach((function(t){return t.setLayerLevel(s)}))},t}();var c={isVertical:!1,isRange:!0,shouldDisplayTips:!0,shouldDisplayProgressBar:!0,shouldDisplayScale:!1,minValue:0,maxValue:100,step:1,pointerPosition:20,secondPointerPosition:80},h=function(){return h=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},h.apply(this,arguments)};const p=function(){function t(t,e){this.state=c,this.observer=e,this.state=this.getNextState(t)}return t.prototype.setState=function(t){this.state=this.getNextState(t),this.observer.update(this.mapStateToProps())},t.prototype.getState=function(){return this.state},t.prototype.setPositionsPercentage=function(t){var e={};t.pointer&&(e.pointerPosition=this.convertPercentageToPos(t.pointer)),t.secondPointer&&(e.secondPointerPosition=this.convertPercentageToPos(t.secondPointer)),this.setState(e)},t.prototype.setPositionPercentage=function(t){var e=this.convertPercentageToPos(t),i=e-this.state.pointerPosition<this.state.secondPointerPosition-e;this.setState(!this.state.isRange||i?{pointerPosition:e}:{secondPointerPosition:e})},t.prototype.mapStateToProps=function(){return h(h({},this.state),{pointerPosPercentage:this.convertPosToPercentage(this.state.pointerPosition),secondPointerPosPercentage:this.convertPosToPercentage(this.state.secondPointerPosition),tipValue:this.convertPosToString(this.state.pointerPosition),secondTipValue:this.convertPosToString(this.state.secondPointerPosition),scaleLabels:this.createScaleLabels()})},t.prototype.convertPosToPercentage=function(t){var e=this.state,i=e.maxValue,s=e.minValue;return(t-s)/(i-s)*100},t.prototype.convertPercentageToPos=function(t){var e=this.state,i=e.maxValue,s=e.minValue;return s+t/100*(i-s)},t.prototype.convertPosToString=function(t){return t>1e6?t.toExponential(5):this.getRoundedValue(t,this.state.step).toString()},t.prototype.createScaleLabels=function(){for(var t=this.state,e=t.maxValue,i=t.minValue,s=t.step,n=Math.ceil((e-i)/(25*s))*s,o=[],r=i;r<=e;r+=n)o.push({posPercentage:this.convertPosToPercentage(r),val:this.convertPosToString(r)});return o},t.prototype.getNextState=function(t){return this.nextState=h(h({},this.state),t),this.normalizeNextStateInterval(),this.normalizeNextStateStep(),this.normalizeNextStatePositions(),this.nextState},t.prototype.normalizeNextStateInterval=function(){if(!(this.nextState.maxValue>this.nextState.minValue)){var t=this.state.maxValue!==this.nextState.maxValue,e=this.state.minValue!==this.nextState.minValue;t&&e?this.nextState=h({},this.state):t?this.nextState.minValue=this.nextState.maxValue-1:this.nextState.maxValue=this.nextState.minValue+1}},t.prototype.normalizeNextStateStep=function(){var t=this.nextState.maxValue-this.nextState.minValue;this.nextState.step<=0&&(this.nextState.step=1),this.nextState.step>t&&(this.nextState.step=t)},t.prototype.normalizeNextStatePositions=function(){var t=this,e=this.nextState,i=e.step,s=e.minValue,n=e.maxValue,o=[e.pointerPosition,e.secondPointerPosition].map((function(e){var o=Math.round((e-s)/i)*i+s,r=t.getRoundedValue(o,i);return o<s?s:o>n||n-e<e-o?n:r})),r=o[0],a=o[1];this.nextState.pointerPosition=r,this.nextState.secondPointerPosition=a},t.prototype.getRoundedValue=function(t,e){var i=e%1==0?0:e.toString().split(".")[1].length;return Number.parseFloat(t.toFixed(i))},t}(),l=function(){function t(t,e,i){this.observer=i,this.model=new p(e,this.createModelObserver()),this.view=new a(t,this.createViewObserver()),this.model.setState({})}return t.prototype.getOptions=function(){return this.model.getState()},t.prototype.setOptions=function(t){this.model.setState(t)},t.prototype.createViewObserver=function(){return{move:this.handleViewMove.bind(this),startMove:this.handleViewStartMove.bind(this),endMove:this.handleViewEndMove.bind(this),click:this.handleViewClick.bind(this)}},t.prototype.createModelObserver=function(){return{update:this.handleModelUpdate.bind(this)}},t.prototype.handleModelUpdate=function(t){this.observer.update(),this.view.render(t)},t.prototype.handleViewStartMove=function(){this.observer.start()},t.prototype.handleViewEndMove=function(){this.observer.stop()},t.prototype.handleViewMove=function(t,e){var i=e?{secondPointer:t}:{pointer:t};this.model.setPositionsPercentage(i),this.observer.slide()},t.prototype.handleViewClick=function(t){this.model.setPositionPercentage(t),this.observer.start(),this.observer.slide(),this.observer.stop()},t}();return $.fn.superSlider=function(t){var e=$(this),i=e.data("sliderInterface");if(i)t&&i.setOptions(t);else{var s={update:function(){e.trigger("sliderupdate")},start:function(){e.trigger("slidestart")},slide:function(){e.trigger("slide")},stop:function(){e.trigger("slidestop")}},n=t||{};e.data("sliderInterface",new l(e,n,s))}return e},t})()}));